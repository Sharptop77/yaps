# YAPS  ‚Äî –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –¥–ª—è Linux –∏ Kubernetes (RKE2)

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

**YAPS** (Yet Another Process Scanner) ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ Linux-—Ö–æ—Å—Ç–∞—Ö, –≤–∫–ª—é—á–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã –∏ –∫–ª–∞—Å—Ç–µ—Ä—ã Kubernetes (–æ—Å–æ–±–µ–Ω–Ω–æ RKE2/–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–µ —Å—Ä–µ–¥—ã). –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö –∏ –ø–æ–¥–∞—Ö Kubernetes, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –∏ —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (—Ç–∞–±–ª–∏—Ü–∞, JSON, YAML).

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∞–Ω–∞–ª–æ–≥–∞–º–∏ (`top`, `htop`, `glances`, `btop`, –∏ –¥—Ä.):

- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:** –Ø–≤–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (Docker, containerd, LXC, systemd-nspawn, Kubernetes-crictl), –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö top/htop.
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kubernetes/RKE2:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ namespace, pod, UID, QoS-–∫–ª–∞—Å—Å–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ Kubernetes/RKE2 —á–µ—Ä–µ–∑ –ø—Ä—è–º—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å kubelet –∏ crictl.
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º –∏ Kubernetes:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö namespace, pod-–æ–≤ –∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Ç–æ–ª—å–∫–æ Kubernetes, —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–µ –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã.
- **–†–∞—Å—à–∏—Ä—è–µ–º—ã–π –≤—ã–≤–æ–¥:** –ü–æ–∫–∞–∑ –≤—Å–µ—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–∞ (PID, PPID, CPU%, –ø–∞–º—è—Ç—å, swap, —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å, uid/user, –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞/–ø–æ–¥–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, Kubernetes-namespace/Pod –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ).
- **–≠–∫—Å–ø–æ—Ä—Ç –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** –í—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ç–∞–±–ª–∏—Ü—ã, JSON –∏–ª–∏ YAML –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –∏–ª–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.
- **CLI-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ù–∞ –±–∞–∑–µ cobra ‚Äî –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å, —Ä–∞–∑–≤–∏–≤–∞—Ç—å, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –ø–∞–π–ø–ª–∞–π–Ω—ã, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥.
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –±—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤/–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Ä–∞–±–æ—Ç—ã –Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Ö–æ—Å—Ç–∞—Ö.

### –ö–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å YAPS 
- –î–ª—è —Ç–æ—á–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö (–æ—Å–æ–±–µ–Ω–Ω–æ RKE2/k3s/k8s —Å containerd/crictl), –∫–æ–≥–¥–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ (htop, top, glances) –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤/namespace.
- –ü—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤–æ–∏—Ö own-—ç–∫—Å–ø–æ—Ä—Ç–æ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∏ –∏ alert-—Ü–µ–ø–æ—á–∫–∏).
- –î–ª—è —Å–±–æ—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–¥–∞—Ö, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö –∏–ª–∏ —é–∑–µ—Ä–∞—Ö —Å –≤—ã–≤–æ–¥–æ–º –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∏—Ç—å csv/json –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞).

## –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- Go 1.19+
- Linux —Å–∏—Å—Ç–µ–º–∞
- –î–æ—Å—Ç—É–ø –∫ `/proc` —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π crictl (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kubernetes)
- –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Docker ‚Äî docker.sock, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å, –ª–∏–±–æ —Ç–æ–ª—å–∫–æ —Ä–µ–∂–∏–º containerd

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ:
```bash
git clone https://github.com/Sharptop77/yaps.git
cd yaps
go build -o yaps yaps.go
```

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è


### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞ 3 –∫–æ–º–∞–Ω–¥—ã
```bash
# 1. –°–∫–∞—á–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
go mod download

# 2. –°–æ–±—Ä–∞—Ç—å
go build -o yaps yaps.go

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å
./yaps
```
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö (–µ—Å–ª–∏ –µ—Å—Ç—å).

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (CLI)

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `--show-cpu` (`-c`) ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å CPU usage
- `--show-mem` (`-m`) ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–∞–º—è—Ç—å
- `--show-swap` (`-s`) ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å swap
- `--show-cmd` (`-C`) ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É
- `--show-user` (`-u`) ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `--show-io` (`-i`) ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–≤–æ–¥-–≤—ã–≤–æ–¥ 
- `--show-container` ‚Äî –§–ª–∞–≥ ‚Äû–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–ª–∏ –Ω–µ—Ç‚Äù
- `--container-id` ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å ID –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `--container-name` ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `--show-k8s` ‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—è Kubernetes (namespace/pod/QoS)
- `--k8s-only` ‚Äî –¢–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–∑ Kubernetes –ø–æ–¥–æ–≤
- `--k8s-namespace=<–∏–º—è>` ‚Äî –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ namespace
- `--output table|json|yaml` ‚Äî –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: table)
- `--sort-by=–ø–æ–ª–µ` ‚Äî –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ª—é
- `--cpu-interval=1s` ‚Äî –ò–Ω—Ç–µ—Ä–≤–∞–ª –∏–∑–º–µ—Ä–µ–Ω–∏—è CPU (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1s)
- `--container-only` ‚Äî –¢–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- `--pid –ü–ò–î[,–ü–ò–î..]` ‚Äî –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ PID
- `--user <UID|user>` ‚Äî –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `--set-filter` (`-f`) ‚Äî –†–µ—Å—É—Ä—Å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (cpu>50, memory>1g –∏ —Ç.–¥.)

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
./yaps

# CPU –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
./yaps -c

# –†–µ—Å—É—Ä—Å—ã (CPU + –ø–∞–º—è—Ç—å + swap)
./yaps -r

# –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
./yaps --container-only --container-name
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã
```bash
# –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ CPU
./yaps -c --cpu-interval 500ms --sort-by cpu | head -10

# –ê–Ω–∞–ª–∏–∑ –ø–∞–º—è—Ç–∏
./yaps -m -f "memory>100MB" --sort-by memory

# JSON –≤—ã–≤–æ–¥ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
./yaps --container-only -r -o json > containers.json

# –ü—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
./yaps --user root -r --sort-by cpu

# –í—ã–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º namespace Kubernetes
./yaps --k8s-namespace default --show-cpu --show-mem --show-k8s

#–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö
./yaps --output json | jq '.[] | select(.cpu_percent > 10.0)'
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```bash
# –ö–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ø –ø–æ CPU
watch -n 2 './yaps -c --cpu-interval 1s --sort-by cpu | head -10'

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
while true; do
  echo "$(date): $(./yaps -c -f "cpu>10" --sort-by cpu | head -5)"
  sleep 30
done
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–µ—Ä–≤–∏—Å—ã –∏ –ø–∞–π–ø–ª–∞–π–Ω—ã
- –ú–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ cron/systemd –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π tool –≤ Ansible/CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∞—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è "–∂–∏–≤–æ–≥–æ" —Å—Ä–µ–∑–∞ –ø–æ –ø—Ä–æ—Ü–µ—Å—Å–∞–º
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞ production-—Å–µ—Ä–≤–µ—Ä–∞—Ö —Å Kubernetes (–æ—Å–æ–±–µ–Ω–Ω–æ RKE2/k3s)
- –ú–æ–∂–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å –≤—ã–≤–æ–¥ –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞/–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## –ü—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞

- –î–ª—è Kubernetes-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ namespace, pod, pod_uid, QoS –∏ –¥—Ä.
- –§–æ—Ä–º–∞—Ç—ã –≤—ã–≤–æ–¥–∞ —É–¥–æ–±–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å jq, yq, awk (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º)


## üì¶ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ù–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ
```bash
# 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª
scp yaps.go user@server:/tmp/

# 2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–æ–±—Ä–∞—Ç—å
ssh user@server "cd /tmp && go build -o yaps yaps.go"

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
ssh user@server "sudo mv /tmp/yaps /usr/local/bin/"
```

### –í Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
```dockerfile
FROM golang:1.21-alpine AS builder
COPY yaps.go /app/
WORKDIR /app
RUN go mod init yaps && \\
    go mod tidy && \\
    go build -o yaps yaps.go

FROM alpine:latest
RUN apk --no-cache add ca-certificates
COPY --from=builder /app/yaps /usr/local/bin/
CMD ["yaps"]
```

### –ö–∞–∫ systemd —Å–µ—Ä–≤–∏—Å (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å —Ñ–∞–π–ª
sudo tee /etc/systemd/system/yaps.service << EOF
[Unit]
Description=Process Monitor
After=network.target

[Service]
Type=simple
ExecStart=/usr/local/bin/yaps --container-only -r -o json
Restart=always
User=monitoring

[Install]
WantedBy=multi-user.target
EOF

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl enable yaps
sudo systemctl start yaps
```

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
# –ë—ã—Å—Ç—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è
go run yaps.go -c --pid 1-100

# –û—Ç–ª–∞–¥–∫–∞ —Å verbose –≤—ã–≤–æ–¥–æ–º
go run yaps.go -r 2>/dev/null  # —É–±—Ä–∞—Ç—å stderr
```

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```bash
# –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è —Å–±–æ—Ä–∫–∞
go build -ldflags "-s -w" -o yaps yaps.go

# –°–∂–∞—Ç–∏–µ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
upx --best yaps  # –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω UPX
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
```bash
# –° jq –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ JSON
./yaps --container-only -o json | jq '.[] | select(.cpu_percent > 10)'

# –° awk –¥–ª—è —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
./yaps -c | awk 'NR>1 && $3>5 {print $1, $3}' # PID –∏ CPU > 5%

# –° curl –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ—Ç—Ä–∏–∫
./yaps -o json | curl -X POST -d @- http://monitoring-server/metrics
```

## üìã –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- [ ] Go 1.19+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –î–æ—Å—Ç—É–ø –∫ `/proc` —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
- [ ] –ü—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ `/etc/passwd` (–¥–ª—è –∏–º–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- [ ] –î–æ—Å—Ç—É–ø –∫ `/var/run/docker.sock` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∏–º–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤)
- [ ] –ü—Ä–∞–≤–∞ –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É –≤ `/usr/local/bin` (–¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏)

## üéâ –ì–æ—Ç–æ–≤–æ!